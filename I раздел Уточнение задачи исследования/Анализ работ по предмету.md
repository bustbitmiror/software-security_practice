Ядро - это основная часть компьютерной операционной системы (OS), которая играет важную роль в управлении компьютерными ресурсами. В последнее время одним из наиболее неуловимых типов вредоносных программ, создающих серьезные проблемы в системе компьютерной безопасности, являются руткиты на уровне ядра. Руткиты на уровне ядра могут скрывать свое присутствие и вредоносные действия, изменяя поток управления ядром, подключаясь к пространству ядра или манипулируя объектами ядра. Поскольку руткиты на уровне ядра изменяют ядро, средствам безопасности пользовательского уровня трудно обнаружить руткиты на уровне ядра. 

За последние несколько лет было предложено множество подходов для обнаружения руткитов на уровне ядра. Их можно разделить на шесть классов:

* Основанные на сигнатурах;
* Основанные на поведении;
* Основанные на перекрестном просмотре;
* Основанные на целостности;
* Основанные на внешнем оборудовании;
* Основанные на обучении.


Обнаружение на основе сигнатур является одним из наиболее распространенных методов, используемых для устранения программных угроз. Этот тип обнаружения включает в себя средства обнаружения, имеющие предопределенное хранилище статических сигнатур, которые представляют известные угрозы. (Вот некоторые исследования на эту тему. ?) 

В статье "Kernel Rootkits Detection Method by Monitoring Branches Using Hardware Features" исследователи T. Yamauchi, Y. Akao предлагают Kernel Rootkits Guard (KRGuard), который представляет собой новый метод обнаружения руткитов, отслеживающий записи ветвей в пространстве ядра. Поскольку многие руткиты создают ветви, которые отличаются от обычных ветвей в пространстве ядра, KRGuard может обнаружить эти различия, используя аппаратные возможности обычных процессоров.

Потом, L. Zhou, Y. Makris в своей статье "Hardware-assisted rootkit detection via on-line statistical fingerprinting of process execution" представляют иерархическую онлайновую систему с аппаратной поддержкой, которая обнаруживает такие руткиты ядра путем определения отклонения динамических профилей выполнения внутри процесса на основе семантики уровня архитектуры, записанной непосредственно в аппаратном обеспечении. Основное понимание заключается в том, что для того, чтобы вредоносные манипуляции с объектами ядра вступили в силу, они должны исказить поток выполнения безопасных процессов, тем самым оставляя аномальные следы в семантике уровня архитектуры.

Обнаружение на основе поведения оценивает атаку на основе ее предполагаемых действий или поведения. Попытки выполнить действия, которые явно являются ненормальными или несанкционированными, будут указывать на то, что действие является вредоносным или, по крайней мере, подозрительным. Для этого исследователи разрабатывают методы и системы. Вот некоторые статьи на эту тему.


Так, исследователи H. Yin, P. Poosankam, S. Hanna и D. Song в статье "HookScout: Proactive Binary-Centric Hook Detection" предлагают новый метод проактивного обнаружения зацепок и разрабатываем прототип под названием HookScout. Подход ориентирован на двоичный код и, таким образом, позволяет генерировать политику обнаружения перехватов без доступа к исходному коду ядра операционной системы. Он также зависит от контекста и, таким образом, может работать с полиморфными структурами данных.

Потом, в статье "Blacksheep: detecting compromised hosts in homogeneous crowds" A. Bianchi, Y. Shoshitaishvili, C. Kruegel и G. Vigna представляют Blacksheep, распределенную систему для обнаружения заражения руткитами среди групп похожих машин. Такой подход был продиктован однородностью многих корпоративных сетей. Используя преимущества сходства между машинами, которые он анализирует, Blacksheep способен эффективно обнаруживать как существующие, так и новые заражения, сравнивая дампы памяти, собранные с каждого хоста.

Также, исследователи M. Neugschwandtner, C. Platzer, P. M. Comparetti, U. Bayer в своей работе "dAnubis – Dynamic Device Driver Analysis Based on Virtual Machine Introspection" представляют dAnubis, систему для  
динамического анализа вредоносных драйверов устройств Windows в режиме реального времени. dAnubis может автоматически предоставлять высокоуровневый, удобочитаемый отчет о поведении драйвера в системе.

В статье "Fluorescence: Detecting Kernel-Resident Malware in Clouds" R. Li, M. Du, D. Johnson представляют новый подход к обнаружению вредоносных программ, находящихся в ядре, в “стаде” похожих виртуальных машин. Подход использует ограниченные знания об исследуемых ядрах — например, расположение глобального каталога страниц и набор команд процессора — для получения краткого отпечатка каждого ядра. Он не использует семантику, специфичную для ядра, для сравнения отпечатков пальцев и поиска тех, которые представляют аномальные хосты. Они реализуют метод в инструменте под названием Fluorescence и демонстрируют его способность идентифицировать хосты Linux и Windows, зараженные реальным вредоносным ПО, находящимся в ядре.

А также, исследователь J. Wang в своей работе "A rule-based approach for rootkit detection" представил подход к обнаружению руткитов, основанный на правилах. Это основано на том факте, что руткит должен модифицировать некоторые структуры данных системы, чтобы скрыть себя. Но изменения структуры данных обязательно приведут к некоторым несоответствиям в системе. Обнаружив несоответствия в системе, можно обнаружить руткит. Подход состоит из четырех основных этапов: (1) тщательный выбор структур данных на разных уровнях системы; (2) выполняет один и тот же процесс вычисления информации, используя различные уровни структур данных соответственно, и формирует информационное пространство в соответствии с результатом, полученным после каждого вычисления; (3) определяет правила как инварианты на основе информационных пространств, сформированных на шаге (2); (4) если эти правила соблюдаются, система чиста; в противном случае система, вероятно, заражена руткитом.



Основная идея обнаружения на основе перекрестного просмотра заключается в сравнении двух различных представлений системы. Можно разделить обнаружение, основанное на перекрестном просмотре, на две подкатегории: высокоуровневый просмотр и низкоуровневый просмотр, встроенный просмотр и внешний просмотр. 

Так, исследователи Y.-M. Wang, D. Beck, B. Vo в статье "Detecting stealth software with Strider GhostBuster" сосредоточились на подклассе вредоносных программ, называемых "ghostware", которые скрывают файлы, параметры конфигурации, процессы и загруженные модули из интерфейсов прикладного программирования запросов и перечислений операционной системы (API). Вместо того, чтобы ориентироваться на отдельные реализации скрытности, они описывают систематическую структуру для обнаружения нескольких типов скрытых ресурсов, используя поведение скрытия в качестве механизма обнаружения. В частности, они применяют основанный на перекрестном просмотре подход к обнаружению программ-призраков, сравнивая высокоуровневое зараженное сканирование с низкоуровневым чистым сканированием и альтернативно сравнивая встроенное зараженное сканирование с внешним чистым сканированием. Они описывают дизайн и реализацию инструмента Strider GhostBuster и демонстрируют его эффективность при обнаружении ресурсов.

В последние годы исследования в области криминалистики памяти процветают, и были разработаны мощные аналитические системы, такие как Volatility. В статье "Timely Rootkit Detection During Live Response" D. Molina, M. Zimmerman и G. Roberts описывают инструмент обнаружения руткитов, предназначенный для поддержки криминалистических расследований, которые включают оперативный анализ компьютерных систем. Инструмент, который не требует предварительной установки, сопоставляет выходные данные нескольких системных утилит сбора данных.

А в статье "Visualizing Indicators of Rootkit Infections in Memory Forensics" исследователи S. Vömel и H. Lenz представляют rkfinder, подключаемый модуль для хорошо известного фреймворка forensic framework DFF, который объединяет основные возможности Volatility в интуитивно понятный и простой в использовании графический пользовательский интерфейс. Rkfinder генерирует абстрактное древовидное представление состояния системы, реализует проверки, способные выявить несоответствия, и автоматически выделяет подозрительные объекты, которые могут указывать на наличие угрозы.

Потом, в своей работе "HyBIS: Advanced Introspection for Effective Windows Guest Protection" R. Di Pietro, F. Franzoni и F. Lombardi представляем и анализируем новую систему самоанализа на основе гипервизора (HyBIS), разработанную для защиты операционных систем Windows от вредоносных программ и руткитов. Сравнение с аналогичными работами высвечивает основные преимущества HyBIS, такие как: эффективный семантический самоанализ, поддержка 64-разрядных архитектур и последних версий Windows (≥ win 7), а также расширенные возможности отключения вредоносных программ.

В последние годы самоанализ виртуальной машины (VMI) превратился в ряд новых мер безопасности. Виртуализированные среды обеспечивают изоляцию, что приводит к повышению безопасности. В статье "WinWizard: Expanding Xen with a LibVMI Intrusion Detection Tool" J. Lamps, I. Palmer и R. Sprabery представили расширение WinWizard для LibVMI, которое создает систему обнаружения вторжений на основе VMI (IDS) с акцентом на самоанализ памяти. WinWizard способен обнаруживать руткиты, которые пытаются скрыть процессы от администратора. 










Руткит на уровне ядра нарушает целостность как статической, так и динамической областей операционной системы. В то время как некоторые исследования фокусируются только на целостности статической области, недавние исследования сосредоточены на целостности динамической области, поскольку современные руткиты на уровне ядра в основном изменяют динамические структуры данных. 



