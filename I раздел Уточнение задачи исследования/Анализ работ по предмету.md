<!-- Ядро - это основная часть компьютерной операционной системы (OS), которая играет важную роль в управлении компьютерными ресурсами. В последнее время одним из наиболее неуловимых типов вредоносных программ, создающих серьезные проблемы в системе компьютерной безопасности, являются руткиты на уровне ядра. Руткиты на уровне ядра могут скрывать свое присутствие и вредоносные действия, изменяя поток управления ядром, подключаясь к пространству ядра или манипулируя объектами ядра. Поскольку руткиты на уровне ядра изменяют ядро, средствам безопасности пользовательского уровня трудно обнаружить руткиты на уровне ядра.  -->

### 1.2 Анализ работ по предмету исследования

Ядро представляет собой основной компонент операционной системы (ОС), который выступает важным элементом в управлении ресурсами компьютера. В настоящее время одним из наиболее разрушительных видов вредоносных программ, вызывающих серьезные проблемы в области компьютерной безопасности, являются руткиты, действующие на уровне ядра. Эти руткиты на уровне ядра способны скрывать своё присутствие и вредоносные действия, путем модификации потоков управления ядром, взаимодействия с пространством ядра или манипуляции с объектами, связанными с ядром. Из-за того, что руткиты на уровне ядра осуществляют изменения в самом ядре, системам безопасности на пользовательском уровне затруднительно обнаружить такие руткиты.


За последние несколько лет было предложено множество подходов для обнаружения руткитов на уровне ядра. Их можно разделить на шесть классов:

* Основанные на сигнатурах;
* Основанные на поведении;
* Основанные на перекрестном просмотре;
* Основанные на целостности;
* Основанные на внешнем оборудовании;
* Основанные на обучении.


Обнаружение на основе сигнатур является одним из наиболее распространенных методов, используемых для устранения программных угроз. Этот тип обнаружения включает в себя средства обнаружения, имеющие предопределенное хранилище статических сигнатур, которые представляют известные угрозы. (Вот некоторые исследования на эту тему. ?) 

В статье "Kernel Rootkits Detection Method by Monitoring Branches Using Hardware Features" исследователи T. Yamauchi, Y. Akao предлагают Kernel Rootkits Guard (KRGuard), который представляет собой новый метод обнаружения руткитов, отслеживающий записи ветвей в пространстве ядра. Поскольку многие руткиты создают ветви, которые отличаются от обычных ветвей в пространстве ядра, KRGuard может обнаружить эти различия, используя аппаратные возможности обычных процессоров.

Потом, L. Zhou, Y. Makris в своей статье "Hardware-assisted rootkit detection via on-line statistical fingerprinting of process execution" представляют иерархическую онлайновую систему с аппаратной поддержкой, которая обнаруживает такие руткиты ядра путем определения отклонения динамических профилей выполнения внутри процесса на основе семантики уровня архитектуры, записанной непосредственно в аппаратном обеспечении. Основное понимание заключается в том, что для того, чтобы вредоносные манипуляции с объектами ядра вступили в силу, они должны исказить поток выполнения безопасных процессов, тем самым оставляя аномальные следы в семантике уровня архитектуры.

Обнаружение на основе поведения оценивает атаку на основе ее предполагаемых действий или поведения. Попытки выполнить действия, которые явно являются ненормальными или несанкционированными, будут указывать на то, что действие является вредоносным или, по крайней мере, подозрительным. Для этого исследователи разрабатывают методы и системы. Вот некоторые статьи на эту тему.


Так, исследователи H. Yin, P. Poosankam, S. Hanna и D. Song в статье "HookScout: Proactive Binary-Centric Hook Detection" предлагают новый метод проактивного обнаружения зацепок и разрабатываем прототип под названием HookScout. Подход ориентирован на двоичный код и, таким образом, позволяет генерировать политику обнаружения перехватов без доступа к исходному коду ядра операционной системы. Он также зависит от контекста и, таким образом, может работать с полиморфными структурами данных.

Потом, в статье "Blacksheep: detecting compromised hosts in homogeneous crowds" A. Bianchi, Y. Shoshitaishvili, C. Kruegel и G. Vigna представляют Blacksheep, распределенную систему для обнаружения заражения руткитами среди групп похожих машин. Такой подход был продиктован однородностью многих корпоративных сетей. Используя преимущества сходства между машинами, которые он анализирует, Blacksheep способен эффективно обнаруживать как существующие, так и новые заражения, сравнивая дампы памяти, собранные с каждого хоста.

Также, исследователи M. Neugschwandtner, C. Platzer, P. M. Comparetti, U. Bayer в своей работе "dAnubis – Dynamic Device Driver Analysis Based on Virtual Machine Introspection" представляют dAnubis, систему для динамического анализа вредоносных драйверов устройств Windows в режиме реального времени. dAnubis может автоматически предоставлять высокоуровневый, удобочитаемый отчет о поведении драйвера в системе.

В статье "Fluorescence: Detecting Kernel-Resident Malware in Clouds" R. Li, M. Du, D. Johnson представляют новый подход к обнаружению вредоносных программ, находящихся в ядре, в “стаде” похожих виртуальных машин. Подход использует ограниченные знания об исследуемых ядрах — например, расположение глобального каталога страниц и набор команд процессора — для получения краткого отпечатка каждого ядра. Он не использует семантику, специфичную для ядра, для сравнения отпечатков пальцев и поиска тех, которые представляют аномальные хосты. Они реализуют метод в инструменте под названием Fluorescence и демонстрируют его способность идентифицировать хосты Linux и Windows, зараженные реальным вредоносным ПО, находящимся в ядре.

А также, исследователь J. Wang в своей работе "A rule-based approach for rootkit detection" представил подход к обнаружению руткитов, основанный на правилах. Это основано на том факте, что руткит должен модифицировать некоторые структуры данных системы, чтобы скрыть себя. Но изменения структуры данных обязательно приведут к некоторым несоответствиям в системе. Обнаружив несоответствия в системе, можно обнаружить руткит. Подход состоит из четырех основных этапов: (1) тщательный выбор структур данных на разных уровнях системы; (2) выполняет один и тот же процесс вычисления информации, используя различные уровни структур данных соответственно, и формирует информационное пространство в соответствии с результатом, полученным после каждого вычисления; (3) определяет правила как инварианты на основе информационных пространств, сформированных на шаге (2); (4) если эти правила соблюдаются, система чиста; в противном случае система, вероятно, заражена руткитом.



Основная идея обнаружения на основе перекрестного просмотра заключается в сравнении двух различных представлений системы. Можно разделить обнаружение, основанное на перекрестном просмотре, на две подкатегории: высокоуровневый просмотр и низкоуровневый просмотр, встроенный просмотр и внешний просмотр. 

Так, исследователи Y.-M. Wang, D. Beck, B. Vo в статье "Detecting stealth software with Strider GhostBuster" сосредоточились на подклассе вредоносных программ, называемых "ghostware", которые скрывают файлы, параметры конфигурации, процессы и загруженные модули из интерфейсов прикладного программирования запросов и перечислений операционной системы (API). Вместо того, чтобы ориентироваться на отдельные реализации скрытности, они описывают систематическую структуру для обнаружения нескольких типов скрытых ресурсов, используя поведение скрытия в качестве механизма обнаружения. В частности, они применяют основанный на перекрестном просмотре подход к обнаружению программ-призраков, сравнивая высокоуровневое зараженное сканирование с низкоуровневым чистым сканированием и альтернативно сравнивая встроенное зараженное сканирование с внешним чистым сканированием. Они описывают дизайн и реализацию инструмента Strider GhostBuster и демонстрируют его эффективность при обнаружении ресурсов.

В последние годы исследования в области криминалистики памяти процветают, и были разработаны мощные аналитические системы, такие как Volatility. В статье "Timely Rootkit Detection During Live Response" D. Molina, M. Zimmerman и G. Roberts описывают инструмент обнаружения руткитов, предназначенный для поддержки криминалистических расследований, которые включают оперативный анализ компьютерных систем. Инструмент, который не требует предварительной установки, сопоставляет выходные данные нескольких системных утилит сбора данных.

А в статье "Visualizing Indicators of Rootkit Infections in Memory Forensics" исследователи S. Vömel и H. Lenz представляют rkfinder, подключаемый модуль для хорошо известного фреймворка forensic framework DFF, который объединяет основные возможности Volatility в интуитивно понятный и простой в использовании графический пользовательский интерфейс. Rkfinder генерирует абстрактное древовидное представление состояния системы, реализует проверки, способные выявить несоответствия, и автоматически выделяет подозрительные объекты, которые могут указывать на наличие угрозы.

Потом, в своей работе "HyBIS: Advanced Introspection for Effective Windows Guest Protection" R. Di Pietro, F. Franzoni и F. Lombardi представляем и анализируем новую систему самоанализа на основе гипервизора (HyBIS), разработанную для защиты операционных систем Windows от вредоносных программ и руткитов. Сравнение с аналогичными работами высвечивает основные преимущества HyBIS, такие как: эффективный семантический самоанализ, поддержка 64-разрядных архитектур и последних версий Windows (≥ win 7), а также расширенные возможности отключения вредоносных программ.

В последние годы самоанализ виртуальной машины (VMI) превратился в ряд новых мер безопасности. Виртуализированные среды обеспечивают изоляцию, что приводит к повышению безопасности. В статье "WinWizard: Expanding Xen with a LibVMI Intrusion Detection Tool" J. Lamps, I. Palmer и R. Sprabery представили расширение WinWizard для LibVMI, которое создает систему обнаружения вторжений на основе VMI (IDS) с акцентом на самоанализ памяти. WinWizard способен обнаруживать руткиты, которые пытаются скрыть процессы от администратора. 

Также, в статье "HyperLink: Virtual Machine Introspection and Memory Forensic Analysis without Kernel Source Code" J. Xiao, L. Lu, H. Wang и X. Zhu представляют инструмент VMI под названием HyperLink, который частично извлекает информацию о запущенном процессе из гостевой виртуальной машины без ее исходного кода. В то время как текущие решения для самоанализа и криминалистики памяти поддерживают только одну или ограниченное число версий ядра целевой ОС, HyperLink - это инструмент для самоанализа и криминалистики "один на многих", т.е. он поддерживает большинство, если не все, популярных операционных систем независимо от их версий.


Руткит на уровне ядра нарушает целостность как статической, так и динамической областей операционной системы. В то время как некоторые исследования фокусируются только на целостности статической области, недавние исследования сосредоточены на целостности динамической области, поскольку современные руткиты на уровне ядра в основном изменяют динамические структуры данных. 

Гипервизоры были предложены в качестве инструмента безопасности для защиты от вредоносных программ, которые подрывают ядро операционной системы. Однако гипервизоры должны иметь дело с семантическим разрывом между доступной им низкоуровневой информацией и высокоуровневыми абстракциями операционной системы, необходимыми им для анализа. В статье "Hypervisor support for identifying covertly executing binaries" L. Litty, H. A. Lagar-Cavilla и D. Lie представляют Patagonix, систему на основе гипервизора, которая обнаруживает и идентифицирует тайно исполняемые двоичные файлы, не делая предположений о ядре операционной системы. Patagonix зависит только от аппаратного обеспечения процессора для обнаружения выполнения кода и от спецификаций двоичного формата исполняемых файлов для идентификации кода и проверки изменений кода. Благодаря этому Patagonix может предоставлять достоверную информацию о двоичных файлах, запущенных в системе, а также обнаруживать, когда руткит скрывается или вмешивается в исполняемый код.

Потом, динамические данные ядра стали привлекательной мишенью для вредоносных программ в режиме ядра. Однако решения для проверки целостности ядра либо ограничивались кодом и статическими данными, либо могли проверять только часть динамических данных, что приводило к ограниченной защите. Исследователи M. Carbone, W. Cui и L. Lu в своей работе "Mapping kernel objects to enable systematic integrity checking" представили KOP, систему, которая может отображать динамические данные ядра с почти полным охватом и почти идеальной точностью. В отличие от предыдущих подходов, которые игнорируют универсальные указатели, объединения и динамические массивы при поиске динамических объектов ядра, KOP (1) применяет межпроцедурный анализ точек доступа для вычисления всех возможных типов универсальных указателей (например, void*), (2) использует алгоритм сопоставления с образцом для устранения неоднозначностей типов (например,, объединения) и (3) распознает динамические массивы, используя знания о границах пула памяти ядра.

А уже исследователи G. Yan, S. Luo и F. Feng в статье "MOSKG: countering kernel rootkits with a secure paging mechanism" предложили безопасный механизм подкачки и создали внешнюю и прозрачную архитектуру под названием multiple operating systems kernel guard (MOSKG), которая может защитить критически важные данные ядра в различных операционных системах, таких как Windows и Linux, как 32-разрядных, так и 64-разрядных.

Руткит на уровне ядра также может быть обнаружен с помощью внешних аппаратных устройств, а система обнаружения изолирована от контролируемой системы. Хотя этот подход не очень популярен, все же существуют некоторые эффективные решения для обнаружения руткитов на уровне ядра. Этот подход к обнаружению можно разделить на две подкатегории: основанный на Snap и Snoop.

Исследователи L. Koromilas, G. Vasiliadis, E. Athanasopoulos и S. Ioannidis предложили своё решение на основе Snap в статье "GRIM: Leveraging GPUs for Kernel Integrity Monitoring". Они представили GRIM, монитор внешней памяти, который построен на стандартном графическом оборудовании и способен проверять целостность ядра операционной системы со скоростью, превосходящей все опубликованные до сих пор системы на основе моментальных снимков (snapshot-based). GRIM позволяет проверять восемь тысяч 64-разрядных значений одновременно с частотой моментального снимка 10 кГц, что достаточно для точного обнаружения самораспаковывающегося загружаемого модуля ядра.

На таком же подходе обнаружения A. Baliga, V. Ganapathy, L. Iftode в статье "Detecting Kernel-Level Rootkits Using Data Structure Invariants" представили новый метод обнаружения руткитов, которые изменяют как управляющие, так и неконтролируемые данные. Основная идея состоит в том, чтобы внешне наблюдать за выполнением ядра на этапе вывода и выдвигать гипотезы об инвариантах структур данных ядра. Они внедрили Gibraltar, прототип инструмента, который выводит инварианты структуры данных ядра и использует их для обнаружения руткитов.

Обнаружение на основе Snoop H. Moon, H. Lee и I. Heo представили в своей работе "Detecting and Preventing Kernel Rootkit Attacks with Bus Snooping". Чтобы защитить целостность ядер операционной системы, мы представляем систему Vigilare, монитор целостности ядра, архитектура которого позволяет отслеживать трафик шины хост-системы с отдельного независимого аппаратного обеспечения. Они внедрили три прототипа системы Vigilare, добавив в хост-систему модуль аппаратных подключений Snooper для отслеживания шин и монитор на основе моментальных снимков, к которому можно подключаться, чтобы оценить преимущества мониторинга на основе snoop. Прототипы системы Vigilare обнаруживали все временные атаки, а второй защищал ядро с незначительным снижением производительности.


Обнаружение на основе обучения - подход к
автоматическому обнаружению известных и неизвестных атак с высокой точностью. Так, в статье "A Kernel Rootkit Detection Approach Based on Virtualization and Machine Learning" D. Tian, R. Ma, X. Jia и C. Hu предлагают VKRD, систему обнаружения руткитов ядра, основанную на технологии аппаратной виртуализации. По сравнению с предыдущими методами, VKRD может обеспечить прозрачную и эффективную среду выполнения для целевого модуля ядра, чтобы показать его поведение во время выполнения. Чтобы выбрать важные функции во время выполнения для обучения моделей обнаружения, они используют метод TF-IDF. Сочетая методы аппаратной виртуализации и машинного обучения, данное решение для обнаружения руткитов в ядре потенциально может быть применено в облачной среде.

Также, исследователи X. Wang, J. Zhang, A. Zhang, J. Ren в своей работе "TKRD: trusted kernel rootkit detection for cybersecurity of VMs based on machine learning and memory forensic analysis" предлагают метод автоматического обнаружения руткитов ядра в виртуальных машинах из частного облака, сочетая криминалистический анализ памяти виртуальных машин с технологией машинного обучения, основанной на биоинспекции. Вредоносные функции извлекаются из дампов памяти виртуальной машины с помощью метода криминалистического анализа памяти. На основе этих функций обучаются различные классификаторы машинного обучения, включая дерево решений, классификаторы на основе правил, байесовские методы и методы опорных векторов (SVM).

В статье "A Forced Sampled Execution Approach to Kernel Rootkit Identification" J. Wilhelm, T. Chiueh. описывают разработку, внедрение и оценку системы идентификации руткитов ядра для платформы Windows под названием Limbo, которая предотвращает проникновение руткитов ядра в ядро путем проверки легитимности каждого драйвера ядра перед его загрузкой в операционную систему. Limbo определяет, является ли драйвер ядра руткитом ядра, основываясь на его двоичном содержимом и поведении во время выполнения.


Потом, в статье "Identifying stealth malware using CPU power consumption and learning algorithms" P. Luckett, J. T. McDonald и W. B. Glisson предлагают методы поведенческого обнаружения позволяют идентифицировать руткиты, не имеющие ранее зарегистрированных сигнатур. В этом исследовании рассматриваются различные алгоритмы машинного обучения, включая ближайшего соседа, деревья решений, нейронные сети и машины опорных векторов, и предлагается метод определения поведения, основанный на низком энергопотреблении процессора.

Таким образом, было предложено множество подходов, включая подходы, основанные на обучении, для успешного обнаружения и предотвращения руткита на уровне ядра. Однако по-прежнему необходимо решить множество проблем, которые имеют решающее значение для высокой точности обнаружения руткитов на уровне ядра.



